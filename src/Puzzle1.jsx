import { useState, useEffect } from "react";

const sentences = [
"роЕроХро░ роорпБродро▓ роОро┤рпБродрпНродрпЖро▓рпНро▓ро╛роорпН роЖродро┐ рокроХро╡ройрпН роорпБродро▒рпНро▒рпЗ роЙро▓роХрпБ",
"ро╡рпЗрогрпНроЯрпБродро▓рпН ро╡рпЗрогрпНроЯро╛роорпИ роЗро▓ро╛ройроЯро┐ роЪрпЗро░рпНроирпНродро╛ро░рпНроХрпНроХрпБ ропро╛рогрпНроЯрпБроорпН роЗроЯрпБроорпНрокрпИ роЗро▓",
"родрпБрокрпНрокро╛ро░рпНроХрпНроХрпБродрпН родрпБрокрпНрокро╛роп родрпБрокрпНрокро╛роХрпНроХро┐родрпН родрпБрокрпНрокро╛ро░рпНроХрпНроХрпБродрпН родрпБрокрпНрокро╛роп родрпВроЙроорпН рооро┤рпИ",
"роХрпЖроЯрпБрокрпНрокродрпВроЙроорпН роХрпЖроЯрпНроЯро╛ро░рпНроХрпНроХрпБроЪрпН роЪро╛ро░рпНро╡ро╛ропрпНрооро▒рпН ро▒ро╛роЩрпНроХрпЗ роОроЯрпБрокрпНрокродрпВроЙроорпН роОро▓рпНро▓ро╛роорпН рооро┤рпИ",
"роЪрпЖропро▒рпНроХро░ро┐роп роЪрпЖропрпНро╡ро╛ро░рпН рокрпЖро░ро┐ропро░рпН роЪро┐ро▒ро┐ропро░рпН роЪрпЖропро▒рпНроХро░ро┐роп роЪрпЖропрпНроХро▓ро╛ родро╛ро░рпН",
"роЕройрпНро▒ро▒ро┐ро╡ро╛роорпН роОройрпНройро╛родрпБ роЕро▒роЮрпНроЪрпЖропрпНроХ рооро▒рпНро▒родрпБ рокрпКройрпНро▒рпБроЩрпНроХро╛ро▓рпН рокрпКройрпНро▒ро╛родрпН родрпБрогрпИ",
"роЕройрпНрокрпБроорпН роЕро▒ройрпБроорпН роЙроЯрпИродрпНродро╛ропро┐ройрпН роЗро▓рпНро╡ро╛ро┤рпНроХрпНроХрпИ рокрогрпНрокрпБроорпН рокропройрпБроорпН роЕродрпБ",
"ро╡рпИропродрпНродрпБро│рпН ро╡ро╛ро┤рпНро╡ро╛роЩрпНроХрпБ ро╡ро╛ро┤рпНрокро╡ройрпН ро╡ро╛ройрпНроЙроиро▒рпНропрпБроорпН родрпЖропрпНро╡родрпНродрпБро│рпН ро╡рпИроХрпНроХрокрпН рокроЯрпБроорпН",
"родрпЖропрпНро╡роорпН родрпКро┤ро╛роЕро│рпН роХрпКро┤рпБроиройрпН родрпКро┤рпБродрпЖро┤рпБро╡ро╛ро│рпН рокрпЖропрпНропрпЖройрокрпН рокрпЖропрпНропрпБроорпН рооро┤рпИ",
"роИройрпНро▒ рокрпКро┤рпБродро┐ройрпН рокрпЖро░ро┐родрпБро╡роХрпНроХрпБроорпН родройрпНроороХройрпИроЪрпН роЪро╛ройрпНро▒рпЛройрпН роОройроХрпНроХрпЗроЯрпНроЯ родро╛ропрпН",
"роХрпБро┤ро▓рпНроЗройро┐родрпБ ропро╛ро┤рпНроЗройро┐родрпБ роОройрпНрокродроорпН роороХрпНроХро│рпН рооро┤ро▓рпИроЪрпНроЪрпКро▓рпН роХрпЗро│ро╛ родро╡ро░рпН",
"роЕройрпНрокро┐ро▒рпНроХрпБроорпН роЙрогрпНроЯрпЛ роЕроЯрпИроХрпНроХрпБроирпНродро╛ро┤рпН роЖро░рпНро╡ро▓ро░рпН рокрпБройрпНроХрогрпАро░рпН рокрпВроЪро▓рпН родро░рпБроорпН",
"роЕройрпНрокро┐ройрпН ро╡ро┤ро┐ропродрпБ роЙропро┐ро░рпНроиро┐ро▓рпИ роЕроГродро┐ро▓ро╛ро░рпНроХрпНроХрпБ роОройрпНрокрпБродрпЛро▓рпН рокрпЛро░рпНродрпНрод роЙроЯроорпНрокрпБ",
"роорпЛрокрпНрокроХрпН роХрпБро┤рпИропрпБроорпН роЕройро┐роЪрпНроЪроорпН роорпБроХроирпНродро┐ро░ро┐роирпНродрпБ роирпЛроХрпНроХроХрпН роХрпБроиро┤рпНропрпБроорпН ро╡ро┐ро░рпБроирпНродрпБ",
"роЗро░рпБроирпНродрпЛроорпНрокро┐ роЗро▓рпНро╡ро╛ро┤рпНро╡ родрпЖро▓рпНро▓ро╛роорпН ро╡ро┐ро░рпБроирпНродрпЛроорпНрокро┐ ро╡рпЗро│ро╛рогрпНроорпИ роЪрпЖропрпНродро▒рпН рокрпКро░рпБроЯрпНроЯрпБ",
"роЗройрпНроЪрпКро▓ро╛ро▓рпН роИро░роорпН роЕро│рпИроЗрокрпН рокроЯро┐ро▒рпБроЗро▓ро╡ро╛роорпН роЪрпЖроорпНрокрпКро░рпБро│рпН роХрогрпНроЯро╛ро░рпНро╡ро╛ропрпНроЪрпН роЪрпКро▓рпН",
"роЕро▓рпНро▓ро╡рпИ родрпЗроп роЕро▒роорпНрокрпЖро░рпБроХрпБроорпН роиро▓рпНро▓ро╡рпИ роиро╛роЯро┐ роЗройро┐роп роЪрпКро▓ро┐рой",
"роЪрпЖропрпНропро╛рооро▓рпН роЪрпЖропрпНрод роЙродро╡ро┐роХрпНроХрпБ ро╡рпИропроХроорпБроорпН ро╡ро╛ройроХроорпБроорпН роЖро▒рпНро▒ро▓рпН роЕро░ро┐родрпБ",
"рооро▒ро╡ро▒рпНроХ рооро╛роЪро▒рпНро▒ро╛ро░рпН роХрпЗрогрпНроорпИ родрпБро▒ро╡ро▒рпНроХ родрпБройрпНрокродрпНродрпБро│рпН родрпБрокрпНрокро╛ропро╛ро░рпН роироЯрпНрокрпБ",
"роОроирпНроиройрпНро▒ро┐ роХрпКройрпНро▒ро╛ро░рпНроХрпНроХрпБроорпН роЙропрпНро╡рпБрогрпНроЯро╛роорпН роЙропрпНро╡ро┐ро▓рпНро▓рпИ роЪрпЖропрпНроирпНроиройрпНро▒ро┐ роХрпКройрпНро▒ роороХро▒рпНроХрпБ",
"роЕроЯроХрпНроХроорпН роЕрооро░ро░рпБро│рпН роЙропрпНроХрпНроХрпБроорпН роЕроЯроЩрпНроХро╛роорпИ роЖро░ро┐ро░рпБро│рпН роЙропрпНродрпНродрпБ ро╡ро┐роЯрпБроорпН",
"ропро╛роХро╛ро╡ро╛ ро░ро╛ропро┐ройрпБроорпН роиро╛роХро╛роХрпНроХ роХро╛ро╡ро╛роХрпНроХро╛ро▓рпН роЪрпЛроХро╛рокрпНрокро░рпН роЪрпКро▓рпНро▓ро┐ро┤рпБроХрпНроХрпБрокрпН рокроЯрпНроЯрпБ",
"родрпАропро┐ройро╛ро▒рпН роЪрпБроЯрпНроЯрокрпБрогрпН роЙро│рпНро│ро╛ро▒рпБроорпН роЖро▒ро╛родрпЗ роиро╛ро╡ро┐ройро╛ро▒рпН роЪрпБроЯрпНроЯ ро╡роЯрпБ",
"роТро┤рпБроХрпНроХроорпН ро╡ро┐ро┤рпБрокрпНрокроирпН родро░ро▓ро╛ройрпН роТро┤рпБроХрпНроХроорпН роЙропро┐ро░ро┐ройрпБроорпН роУроорпНрокрокрпН рокроЯрпБроорпН",
"роТро┤рпБроХрпНроХроорпН роЙроЯрпИроорпИ роХрпБроЯро┐роорпИ роЗро┤рпБроХрпНроХроорпН роЗро┤ро┐роирпНрод рокро┐ро▒рокрпНрокро╛ропрпН ро╡ро┐роЯрпБроорпН",
"роиройрпНро▒ро┐роХрпНроХрпБ ро╡ро┐родрпНродро╛роХрпБроорпН роиро▓рпНро▓рпКро┤рпБроХрпНроХроорпН родрпАропрпКро┤рпБроХрпНроХроорпН роОройрпНро▒рпБроорпН роЗроЯрпБроорпНрокрпИ родро░рпБроорпН",
"рокро┐ро▒ройрпНрокрпКро░рпБро│ро╛ро│рпН рокрпЖроЯрпНроЯрпКро┤рпБроХрпБроорпН рокрпЗродрпИроорпИ роЮро╛ро▓родрпНродрпБ роЕро▒роорпНрокрпКро░рпБро│рпН роХрогрпНроЯро╛ро░рпНроХрогрпН роЗро▓рпН",
"роЕроХро┤рпНро╡ро╛ро░рпИродрпН родро╛роЩрпНроХрпБроорпН роиро┐ро▓роорпНрокрпЛро▓родрпН родроорпНроорпИ роЗроХро┤рпНро╡ро╛ро░рпНрокрпН рокрпКро▒рпБродрпНродро▓рпН родро▓рпИ",
"роиро┐ро▒рпИропрпБроЯрпИроорпИ роирпАроЩрпНроХро╛роорпИ ро╡рпЗрогрпНроЯро┐ройрпН рокрпКро▒рпИропрпБроЯрпИроорпИ рокрпЛро▒рпНро▒ро┐ ропрпКро┤рпБроХрокрпН рокроЯрпБроорпН",
"роТро┤рпБроХрпНроХро╛ро▒ро╛роХрпН роХрпКро│рпНроХ роТро░рпБро╡ройрпНродройрпН роирпЖроЮрпНроЪродрпНродрпБ роЕро┤рпБроХрпНроХро╛ро▒рпБ роЗро▓ро╛род роЗропро▓рпНрокрпБ",
"роЗро▒ро▓рпАройрпБроорпН роОрогрпНрогро╛родрпБ ро╡рпЖроГроХро┐ройрпН ро╡ро┐ро▒ро▓рпНроИройрпБроорпН ро╡рпЗрогрпНроЯро╛роорпИ роОройрпНройрпБроЮрпН роЪрпЖро░рпБроХрпНроХрпБ",
"роХрогрпНрогро┐ройрпНро▒рпБ роХрогрпНрогро▒роЪрпН роЪрпКро▓рпНро▓ро┐ройрпБроорпН роЪрпКро▓рпНро▓ро▒рпНроХ роорпБройрпНройро┐ройрпНро▒рпБ рокро┐ройрпНроирпЛроХрпНроХро╛роЪрпН роЪрпКро▓рпН",
"роЪрпКро▓рпНро▓рпБроХ роЪрпКро▓рпНро▓ро┐ро▒рпН рокропройрпБроЯрпИроп роЪрпКро▓рпНро▓ро▒рпНроХ роЪрпКро▓рпНро▓ро┐ро▒рпН рокропройро┐ро▓ро╛роЪрпН роЪрпКро▓рпН",
"роТродрпНрод родро▒ро┐ро╡ро╛ройрпН роЙропро┐ро░рпНро╡ро╛ро┤рпНро╡ро╛ройрпН рооро▒рпНро▒рпИропро╛ройрпН роЪрпЖродрпНродро╛ро░рпБро│рпН ро╡рпИроХрпНроХрокрпН рокроЯрпБроорпН",
"роЗройрпНройро╛родрпБ роЗро░роХрпНроХрокрпН рокроЯрпБродро▓рпН роЗро░роирпНродро╡ро░рпН роЗройрпНроорпБроХроЩрпН роХро╛рогрпБроорпН роЕро│ро╡рпБ",
"роЗро░родрпНродро▓ро┐ройрпН роЗройрпНройро╛родрпБ рооройрпНро▒ роиро┐ро░рокрпНрокро┐роп родро╛роорпЗ родрооро┐ропро░рпН роЙрогро▓рпН",
"родрпЛройрпНро▒ро┐ройрпН рокрпБроХро┤рпКроЯрпБ родрпЛройрпНро▒рпБроХ роЕроГродро┐ро▓ро╛ро░рпН родрпЛройрпНро▒ро▓ро┐ройрпН родрпЛройрпНро▒ро╛роорпИ роиройрпНро▒рпБ",
"ро╡роЪрпИропрпКро┤ро┐роп ро╡ро╛ро┤рпНро╡ро╛ро░рпЗ ро╡ро╛ро┤рпНро╡ро╛ро░рпН роЗроЪрпИропрпКро┤ро┐роп ро╡ро╛ро┤рпНро╡ро╛ро░рпЗ ро╡ро╛ро┤ро╛ родро╡ро░рпН",
"роЕро░рпБро│ро┐ро▓рпНро▓ро╛ро░рпНроХрпНроХрпБ роЕро╡рпНро╡рпБро▓роХроорпН роЗро▓рпНро▓рпИ рокрпКро░рпБро│ро┐ро▓рпНро▓ро╛ро░рпНроХрпНроХрпБ роЗро╡рпНро╡рпБро▓роХроорпН роЗро▓рпНро▓ро╛роХро┐ ропро╛роЩрпНроХрпБ",
"ро╡ро╛ропрпНроорпИ роОройрокрпНрокроЯрпБро╡родрпБ ропро╛родрпЖройро┐ройрпН ропро╛родрпКройрпНро▒рпБроорпН родрпАроорпИ роЗро▓ро╛род роЪрпКро▓ро▓рпН",
"рокрпКропрпНроорпИропрпБроорпН ро╡ро╛ропрпНроорпИ ропро┐роЯродрпНрод рокрпБро░рпИродрпАро░рпНроирпНрод роиройрпНроорпИ рокропроХрпНроХрпБроорпН роОройро┐ройрпН",
"родройрпНроирпЖроЮрпН роЪро▒ро┐ро╡родрпБ рокрпКропрпНропро▒рпНроХ рокрпКропрпНродрпНродрокро┐ройрпН родройрпНроирпЖроЮрпНроЪрпЗ родройрпНройрпИроЪрпН роЪрпБроЯрпБроорпН",
"рокрпБро▒роирпНродрпВропрпНроорпИ роирпАро░ро╛ройрпН роЕроорпИропрпБроорпН роЕроХроирпНродрпВропрпНроорпИ ро╡ро╛ропрпНроорпИропро╛ро▓рпН роХро╛рогрокрпН рокроЯрпБроорпН",
"роОро▓рпНро▓ро╛ ро╡ро┐ро│роХрпНроХрпБроорпН ро╡ро┐ро│роХрпНроХро▓рпНро▓ роЪро╛ройрпНро▒рпЛро░рпНроХрпНроХрпБрокрпН рокрпКропрпНропро╛ ро╡ро┐ро│роХрпНроХрпЗ ро╡ро┐ро│роХрпНроХрпБ",
"рокро▒рпНро▒рпБроХ рокро▒рпНро▒ро▒рпНро▒ро╛ройрпН рокро▒рпНро▒ро┐ройрпИ роЕрокрпНрокро▒рпНро▒рпИрокрпН рокро▒рпНро▒рпБроХ рокро▒рпНро▒рпБ ро╡ро┐роЯро▒рпНроХрпБ",
"роорпБро▒рпИроЪрпЖропрпНродрпБ роХро╛рокрпНрокро╛ро▒рпНро▒рпБроорпН рооройрпНройро╡ройрпН роороХрпНроХроЯрпНроХрпБ роЗро▒рпИропрпЖройрпНро▒рпБ ро╡рпИроХрпНроХрокрпН рокроЯрпБроорпН",
"роОрогрпНрогрпЖройрпНрок роПройрпИ роОро┤рпБродрпНродрпЖройрпНрок роЗро╡рпНро╡ро┐ро░рогрпНроЯрпБроорпН роХрогрпНрогрпЖройрпНрок ро╡ро╛ро┤рпБроорпН роЙропро┐ро░рпНроХрпНроХрпБ",
"родрпКроЯрпНроЯройрпИродрпН родрпВро▒рпБроорпН роорогро▒рпНроХрпЗрогро┐ рооро╛роирпНродро░рпНроХрпНроХрпБроХрпН роХро▒рпНро▒ройрпИродрпН родрпВро▒рпБроорпН роЕро▒ро┐ро╡рпБ",
"роТро░рпБроорпИроХрпНроХрогрпН родро╛ройрпНроХро▒рпНро▒ роХро▓рпНро╡ро┐ роТро░рпБро╡ро▒рпНроХрпБ роОро┤рпБроорпИропрпБроорпН роПрооро╛рокрпН рокрпБроЯрпИродрпНродрпБ",
];

export default function WordPuzzle() {
  const [currentSentenceIndex, setCurrentSentenceIndex] = useState(0);
  const [shuffledWords, setShuffledWords] = useState([]);
  const [selectedWords, setSelectedWords] = useState([]);
  const [message, setMessage] = useState("");
  const [timeLeft, setTimeLeft] = useState(120);
  const [correctCount, setCorrectCount] = useState(0);
  const [wrongCount, setWrongCount] = useState(0);
  const [correctlyPlaced, setCorrectlyPlaced] = useState(0);
  const [totalCorrectWords, setTotalCorrectWords] = useState(0);

  useEffect(() => {
    resetGame();
  }, [currentSentenceIndex]); // Resets game when sentence index changes

  useEffect(() => {
    const timer = setInterval(() => {
      setTimeLeft((prev) => {
        if (prev <= 1) {
          clearInterval(timer);
  
          // Delay alert to ensure the latest values are used
          setTimeout(() => {
            alert(`Time up!\nтЬЕ Correct Sentences: ${correctCount}\nтЭМ Wrong Attempts: ${wrongCount}\nЁЯУК Total Correctly Placed Words: ${totalCorrectWords}`);
          }, 100); 
  
          return 0;
        }
        return prev - 1;
      });
    }, 1000);
  
    return () => clearInterval(timer);
  }, [correctCount, wrongCount, totalCorrectWords]); // Depend on these values to ensure latest updates
  
  const resetGame = () => {
    const sentence = sentences[currentSentenceIndex];
    const words = sentence.split(" ");
    setShuffledWords([...words].sort(() => Math.random() - 0.5));
    setSelectedWords([]);
    setMessage("");
    setCorrectlyPlaced(0);
  };

  const handleWordClick = (word, index) => {
    setSelectedWords((prev) => [...prev, word]);
    setShuffledWords((prev) => prev.filter((_, i) => i !== index));

    const correctWords = sentences[currentSentenceIndex].split(" ");
    if (word === correctWords[selectedWords.length]) {
      setCorrectlyPlaced((prev) => prev + 1);
      setTotalCorrectWords((prev) => prev + 1);
    }
  };

  const handleSubmit = () => {
    const sentence = sentences[currentSentenceIndex];
    if (selectedWords.join(" ") === sentence) {
      setMessage("тЬЕ Correct!");
      setCorrectCount((prev) => prev + 1);
    } else {
      setMessage("тЭМ Incorrect. Try again!");
      setWrongCount((prev) => prev + 1);
    }

    setTimeout(() => {
      setCurrentSentenceIndex((prev) => (prev + 1) % sentences.length); // Move to the next sentence
    }, 1500);
  };

  return (
    <div className="p-4 text-center min-h-screen flex flex-col items-center justify-center bg-black text-white">
      <h2 className="text-2xl font-bold mb-6">родрооро┐ро┤рпН рооройрпНро▒роорпН 

ро╡ро┤роЩрпНроХрпБроорпН 

родро┐ро░рпБроХрпНроХрпБро▒ро│рпН родро┐ро▒ройро╛ропрпНро╡рпБ</h2>

      <p className="text-lg font-bold mt-2">тЬФя╕П Correctly Placed Words: {correctlyPlaced}</p>

      <div className="grid grid-cols-4 gap-2 mb-2 border border-gray-500 p-2 rounded-lg w-fit">
        {Array.from({ length: sentences[currentSentenceIndex].split(" ").length }).map((_, index) => (
          <div
            key={index}
            className="border px-4 py-2 bg-gray-800 rounded-md text-white flex items-center justify-center"
            style={{ minWidth: `${selectedWords[index] ? selectedWords[index].length * 12 : 50}px` }}
          >
            {selectedWords[index] || ""}
          </div>
        ))}
      </div>

      <div className="flex gap-2 flex-wrap border border-gray-500 p-4 rounded-lg">
        {shuffledWords.map((word, index) => (
          <button
            key={index}
            className="border px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-all"
            style={{ minWidth: `${word.length * 12}px` }}
            onClick={() => handleWordClick(word, index)}
          >
            {word}
          </button>
        ))}
      </div>

      <button className="mt-4 px-6 py-3 bg-green-500 text-white rounded-md hover:bg-green-600 transition-all" onClick={handleSubmit}>
        Submit
      </button>

      {message && <p className="mt-4 font-bold text-lg">{message}</p>}

      <p className="mt-4 text-lg">тП│ Time Left: {timeLeft}s</p>
    </div>
  );
}
